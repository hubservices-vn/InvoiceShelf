import{a8 as me,ae as ce,G as pe,E as ge,F as be,v as fe,e as Ce,L as _e,f as h,k as B,j as $e,X as ye,r as c,o as C,m as _,w as a,a as r,b as p,J as A,p as P,t as $,l as e,af as ve,K as V,n as S,c as N,q as Ve,g,h as R,I as F,ag as H,i as he,a0 as we,ah as Be,ai as k}from"./main-BUqFeZBO.js";import{_ as Me}from"./CreateCustomFields-CJNrm9Wf.js";import{_ as Ie}from"./CategoryModal-CliltnPR.js";import{u as xe}from"./category-CkcD3_FT.js";import"./dynamic-import-helper-BheWnx7M.js";const Ue={class:"flex items-center justify-end"},Se={class:"grid grid-cols-5 gap-4 mb-8"},ke={class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},qe={class:"grid grid-cols-5 gap-4 mb-8"},Le={class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},ze={class:"md:col-span-2"},Pe={class:"text-sm text-gray-500"},Fe={class:"grid grid-cols-5 gap-4 mb-8"},De={class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},Ee={class:"space-y-6"},Ge={class:"flex items-center justify-start mb-6 md:justify-end md:mb-0"},Te={class:"p-1"},je={key:0,class:"grid grid-cols-5 gap-4 mb-8"},Ae={class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},Ne={class:"space-y-6"},Re={class:"grid grid-cols-5 gap-2 mb-8"},He={key:0,class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},Oe={class:"col-span-5 lg:col-span-4"},O="customFields",Ze={__name:"Create",setup(Je){const J=xe(),o=me(),D=ce(),q=pe(),K=ge(),X=be(),{t:m}=fe.useI18n(),Q=Ce(),W=_e();let l=h(!1),b=h(!1),f=h(!1);const M=h(!1),w=B(()=>W.name==="customers.edit");let Y=B(()=>o.isFetchingInitialSettings);const E=B(()=>w.value?m("customers.edit_customer"):m("customers.new_customer"));function Z(){X.openModal({title:m("settings.category.add_category"),componentName:"CategoryModal",size:"sm",refreshData:T,data:{type:"customer"}})}const G=h([]),L=h(!1);async function T(s=void 0){var y;L.value=!0;const t=await J.fetchCategories({search:s,type:"customer"});t.data.data.length&&(G.value=((y=t.data)==null?void 0:y.data)||[]),L.value=!1}const ee=B(()=>({currentCustomer:{name:{required:g.withMessage(m("validation.required"),R),minLength:g.withMessage(m("validation.name_min_length",{count:3}),F(3))},prefix:{minLength:g.withMessage(m("validation.name_min_length",{count:3}),F(3))},currency_id:{required:g.withMessage(m("validation.required"),R)},email:{required:g.withMessage(m("validation.required"),H(o.currentCustomer.enable_portal==!0)),email:g.withMessage(m("validation.email_incorrect"),he)},password:{required:g.withMessage(m("validation.required"),H(o.currentCustomer.enable_portal==!0&&!o.currentCustomer.password_added)),minLength:g.withMessage(m("validation.password_min_length",{count:8}),F(8))},confirm_password:{sameAsPassword:g.withMessage(m("validation.password_incorrect"),we(o.currentCustomer.password))},website:{url:g.withMessage(m("validation.invalid_url"),Be)},billing:{address_street_1:{maxLength:g.withMessage(m("validation.address_maxlength",{count:255}),k(255))},address_street_2:{maxLength:g.withMessage(m("validation.address_maxlength",{count:255}),k(255))}},shipping:{address_street_1:{maxLength:g.withMessage(m("validation.address_maxlength",{count:255}),k(255))},address_street_2:{maxLength:g.withMessage(m("validation.address_maxlength",{count:255}),k(255))}}}})),te=B(()=>`${window.location.origin}/${K.selectedCompany.slug}/customer/login`),i=$e(ee,o,{$scope:O});o.resetCurrentCustomer(),o.fetchCustomerInitialSettings(w.value);async function oe(){if(i.value.$touch(),i.value.$invalid)return!0;M.value=!0;let s={...o.currentCustomer},t=null;try{t=await(w.value?o.updateCustomer:o.addCustomer)(s)}catch{M.value=!1;return}Q.push(`/admin/customers/${t.data.data.id}/view`)}return ye(()=>{T()}),(s,t)=>{const y=c("BaseBreadcrumbItem"),ne=c("BaseBreadcrumb-item"),re=c("BaseBreadcrumb"),v=c("BaseIcon"),j=c("BaseButton"),le=c("BasePageHeader"),d=c("BaseInput"),u=c("BaseInputGroup"),se=c("BaseSelectAction"),ae=c("BaseTreeSelect"),z=c("BaseMultiselect"),I=c("BaseInputGrid"),x=c("BaseDivider"),ie=c("BaseSwitch"),U=c("BaseTextarea"),ue=c("BaseCard"),de=c("BasePage");return C(),_(de,null,{default:a(()=>[r(Ie),p("form",{onSubmit:Ve(oe,["prevent"])},[r(le,{title:E.value},{actions:a(()=>[p("div",Ue,[r(j,{type:"submit",loading:M.value,disabled:M.value},{left:a(n=>[r(v,{name:"SaveIcon",class:A(n.class)},null,8,["class"])]),default:a(()=>[P(" "+$(w.value?s.$t("customers.update_customer"):s.$t("customers.save_customer")),1)]),_:1},8,["loading","disabled"])])]),default:a(()=>[r(re,null,{default:a(()=>[r(y,{title:s.$t("general.home"),to:"dashboard"},null,8,["title"]),r(y,{title:s.$t("customers.customer",2),to:"/admin/customers"},null,8,["title"]),r(ne,{title:E.value,to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),r(ue,{class:"mt-5"},{default:a(()=>[p("div",Se,[p("h6",ke,$(s.$t("customers.basic_info")),1),r(I,{class:"col-span-5 lg:col-span-4"},{default:a(()=>[r(u,{label:s.$t("customers.display_name"),required:"",error:e(i).currentCustomer.name.$error&&e(i).currentCustomer.name.$errors[0].$message,"content-loading":e(l)},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.name,"onUpdate:modelValue":t[0]||(t[0]=n=>e(o).currentCustomer.name=n),"content-loading":e(l),type:"text",name:"name",class:"",invalid:e(i).currentCustomer.name.$error,onInput:t[1]||(t[1]=n=>e(i).currentCustomer.name.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","error","content-loading"]),r(u,{label:s.$t("expenses.category"),"content-loading":e(l)},{default:a(()=>[r(ae,{name:"parent_id","value-prop":"id","label-prop":"name",placeholder:s.$t("expenses.categories.select_a_category"),"parent-prop":"parent_id",options:G.value,"content-loading":e(l),loading:L.value,modelValue:e(o).currentCustomer.category_id,"onUpdate:modelValue":t[2]||(t[2]=n=>e(o).currentCustomer.category_id=n)},{"after-list":a(()=>[r(se,{onClick:Z},{default:a(()=>[r(v,{name:"PlusIcon",class:"h-4 mr-2 -ml-2 text-center text-primary-400"}),P(" "+$(s.$t("settings.category.add_new_category")),1)]),_:1})]),_:1},8,["placeholder","options","content-loading","loading","modelValue"])]),_:1},8,["label","content-loading"]),r(u,{label:s.$t("customers.primary_contact_name"),"content-loading":e(l)},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.contact_name,"onUpdate:modelValue":t[3]||(t[3]=n=>e(o).currentCustomer.contact_name=n),modelModifiers:{trim:!0},"content-loading":e(l),type:"text"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),r(u,{error:e(i).currentCustomer.email.$error&&e(i).currentCustomer.email.$errors[0].$message,"content-loading":e(l),label:s.$t("customers.email")},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.email,"onUpdate:modelValue":t[4]||(t[4]=n=>e(o).currentCustomer.email=n),modelModifiers:{trim:!0},"content-loading":e(l),type:"text",name:"email",invalid:e(i).currentCustomer.email.$error,onInput:t[5]||(t[5]=n=>e(i).currentCustomer.email.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["error","content-loading","label"]),r(u,{label:s.$t("customers.phone"),"content-loading":e(l)},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.phone,"onUpdate:modelValue":t[6]||(t[6]=n=>e(o).currentCustomer.phone=n),modelModifiers:{trim:!0},"content-loading":e(l),type:"text",name:"phone"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),r(u,{label:s.$t("customers.primary_currency"),"content-loading":e(l),error:e(i).currentCustomer.currency_id.$error&&e(i).currentCustomer.currency_id.$errors[0].$message,required:""},{default:a(()=>[r(z,{modelValue:e(o).currentCustomer.currency_id,"onUpdate:modelValue":t[7]||(t[7]=n=>e(o).currentCustomer.currency_id=n),"value-prop":"id",label:"name","track-by":"name","content-loading":e(l),options:e(q).currencies,searchable:"","can-deselect":!1,placeholder:s.$t("customers.select_currency"),invalid:e(i).currentCustomer.currency_id.$error,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","content-loading","error"]),r(u,{error:e(i).currentCustomer.website.$error&&e(i).currentCustomer.website.$errors[0].$message,label:s.$t("customers.website"),"content-loading":e(l)},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.website,"onUpdate:modelValue":t[8]||(t[8]=n=>e(o).currentCustomer.website=n),"content-loading":e(l),type:"url",onInput:t[9]||(t[9]=n=>e(i).currentCustomer.website.$touch())},null,8,["modelValue","content-loading"])]),_:1},8,["error","label","content-loading"]),r(u,{label:s.$t("customers.prefix"),error:e(i).currentCustomer.prefix.$error&&e(i).currentCustomer.prefix.$errors[0].$message,"content-loading":e(l)},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.prefix,"onUpdate:modelValue":t[10]||(t[10]=n=>e(o).currentCustomer.prefix=n),"content-loading":e(l),type:"text",name:"name",class:"",invalid:e(i).currentCustomer.prefix.$error,onInput:t[11]||(t[11]=n=>e(i).currentCustomer.prefix.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","error","content-loading"])]),_:1})]),r(x,{class:"mb-5 md:mb-8"}),p("div",qe,[p("h6",Le,$(s.$t("customers.portal_access")),1),r(I,{class:"col-span-5 lg:col-span-4"},{default:a(()=>[p("div",ze,[p("p",Pe,$(s.$t("customers.portal_access_text")),1),r(ie,{modelValue:e(o).currentCustomer.enable_portal,"onUpdate:modelValue":t[12]||(t[12]=n=>e(o).currentCustomer.enable_portal=n),class:"mt-1 flex"},null,8,["modelValue"])]),e(o).currentCustomer.enable_portal?(C(),_(u,{key:0,"content-loading":e(l),label:s.$t("customers.portal_access_url"),class:"md:col-span-2","help-text":s.$t("customers.portal_access_url_help")},{default:a(()=>[r(ve,{token:te.value},null,8,["token"])]),_:1},8,["content-loading","label","help-text"])):V("",!0),e(o).currentCustomer.enable_portal?(C(),_(u,{key:1,"content-loading":e(l),error:e(i).currentCustomer.password.$error&&e(i).currentCustomer.password.$errors[0].$message,label:s.$t("customers.password")},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.password,"onUpdate:modelValue":t[15]||(t[15]=n=>e(o).currentCustomer.password=n),modelModifiers:{trim:!0},"content-loading":e(l),type:e(b)?"text":"password",name:"password",invalid:e(i).currentCustomer.password.$error,onInput:t[16]||(t[16]=n=>e(i).currentCustomer.password.$touch())},{right:a(()=>[e(b)?(C(),_(v,{key:0,name:"EyeOffIcon",class:"w-5 h-5 mr-1 text-gray-500 cursor-pointer",onClick:t[13]||(t[13]=n=>S(b)?b.value=!e(b):b=!e(b))})):(C(),_(v,{key:1,name:"EyeIcon",class:"w-5 h-5 mr-1 text-gray-500 cursor-pointer",onClick:t[14]||(t[14]=n=>S(b)?b.value=!e(b):b=!e(b))}))]),_:1},8,["modelValue","content-loading","type","invalid"])]),_:1},8,["content-loading","error","label"])):V("",!0),e(o).currentCustomer.enable_portal?(C(),_(u,{key:2,error:e(i).currentCustomer.confirm_password.$error&&e(i).currentCustomer.confirm_password.$errors[0].$message,"content-loading":e(l),label:"Confirm Password"},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.confirm_password,"onUpdate:modelValue":t[19]||(t[19]=n=>e(o).currentCustomer.confirm_password=n),modelModifiers:{trim:!0},"content-loading":e(l),type:e(f)?"text":"password",name:"confirm_password",invalid:e(i).currentCustomer.confirm_password.$error,onInput:t[20]||(t[20]=n=>e(i).currentCustomer.confirm_password.$touch())},{right:a(()=>[e(f)?(C(),_(v,{key:0,name:"EyeOffIcon",class:"w-5 h-5 mr-1 text-gray-500 cursor-pointer",onClick:t[17]||(t[17]=n=>S(f)?f.value=!e(f):f=!e(f))})):(C(),_(v,{key:1,name:"EyeIcon",class:"w-5 h-5 mr-1 text-gray-500 cursor-pointer",onClick:t[18]||(t[18]=n=>S(f)?f.value=!e(f):f=!e(f))}))]),_:1},8,["modelValue","content-loading","type","invalid"])]),_:1},8,["error","content-loading"])):V("",!0)]),_:1})]),r(x,{class:"mb-5 md:mb-8"}),p("div",Fe,[p("h6",De,$(s.$t("customers.billing_address")),1),e(o).currentCustomer.billing?(C(),_(I,{key:0,class:"col-span-5 lg:col-span-4"},{default:a(()=>[r(u,{label:s.$t("customers.name"),"content-loading":e(l)},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.billing.name,"onUpdate:modelValue":t[21]||(t[21]=n=>e(o).currentCustomer.billing.name=n),modelModifiers:{trim:!0},"content-loading":e(l),type:"text",class:"w-full",name:"address_name"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),r(u,{label:s.$t("customers.country"),"content-loading":e(l)},{default:a(()=>[r(z,{modelValue:e(o).currentCustomer.billing.country_id,"onUpdate:modelValue":t[22]||(t[22]=n=>e(o).currentCustomer.billing.country_id=n),"value-prop":"id",label:"name","track-by":"name","resolve-on-load":"",searchable:"","content-loading":e(l),options:e(q).countries,placeholder:s.$t("general.select_country"),class:"w-full"},null,8,["modelValue","content-loading","options","placeholder"])]),_:1},8,["label","content-loading"]),r(u,{label:s.$t("customers.state"),"content-loading":e(l)},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.billing.state,"onUpdate:modelValue":t[23]||(t[23]=n=>e(o).currentCustomer.billing.state=n),"content-loading":e(l),name:"billing.state",type:"text"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),r(u,{"content-loading":e(l),label:s.$t("customers.city")},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.billing.city,"onUpdate:modelValue":t[24]||(t[24]=n=>e(o).currentCustomer.billing.city=n),"content-loading":e(l),name:"billing.city",type:"text"},null,8,["modelValue","content-loading"])]),_:1},8,["content-loading","label"]),r(u,{label:s.$t("customers.address"),error:e(i).currentCustomer.billing.address_street_1.$error&&e(i).currentCustomer.billing.address_street_1.$errors[0].$message||e(i).currentCustomer.billing.address_street_2.$error&&e(i).currentCustomer.billing.address_street_2.$errors[0].$message,"content-loading":e(l)},{default:a(()=>[r(U,{modelValue:e(o).currentCustomer.billing.address_street_1,"onUpdate:modelValue":t[25]||(t[25]=n=>e(o).currentCustomer.billing.address_street_1=n),modelModifiers:{trim:!0},"content-loading":e(l),placeholder:s.$t("general.street_1"),type:"text",name:"billing_street1","container-class":"mt-3",onInput:t[26]||(t[26]=n=>e(i).currentCustomer.billing.address_street_1.$touch())},null,8,["modelValue","content-loading","placeholder"]),r(U,{modelValue:e(o).currentCustomer.billing.address_street_2,"onUpdate:modelValue":t[27]||(t[27]=n=>e(o).currentCustomer.billing.address_street_2=n),modelModifiers:{trim:!0},"content-loading":e(l),placeholder:s.$t("general.street_2"),type:"text",class:"mt-3",name:"billing_street2","container-class":"mt-3",onInput:t[28]||(t[28]=n=>e(i).currentCustomer.billing.address_street_2.$touch())},null,8,["modelValue","content-loading","placeholder"])]),_:1},8,["label","error","content-loading"]),p("div",Ee,[r(u,{"content-loading":e(l),label:s.$t("customers.phone"),class:"text-left"},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.billing.phone,"onUpdate:modelValue":t[29]||(t[29]=n=>e(o).currentCustomer.billing.phone=n),modelModifiers:{trim:!0},"content-loading":e(l),type:"text",name:"phone"},null,8,["modelValue","content-loading"])]),_:1},8,["content-loading","label"]),r(u,{label:s.$t("customers.zip_code"),"content-loading":e(l),class:"mt-2 text-left"},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.billing.zip,"onUpdate:modelValue":t[30]||(t[30]=n=>e(o).currentCustomer.billing.zip=n),modelModifiers:{trim:!0},"content-loading":e(l),type:"text",name:"zip"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"])])]),_:1})):V("",!0)]),r(x,{class:"mb-5 md:mb-8"}),p("div",Ge,[p("div",Te,[r(j,{type:"button","content-loading":e(l),size:"sm",variant:"primary-outline",onClick:t[31]||(t[31]=n=>e(o).copyAddress(!0))},{left:a(n=>[r(v,{name:"DocumentDuplicateIcon",class:A(n.class)},null,8,["class"])]),default:a(()=>[P(" "+$(s.$t("customers.copy_billing_address")),1)]),_:1},8,["content-loading"])])]),e(o).currentCustomer.shipping?(C(),N("div",je,[p("h6",Ae,$(s.$t("customers.shipping_address")),1),r(I,{class:"col-span-5 lg:col-span-4"},{default:a(()=>[r(u,{"content-loading":e(l),label:s.$t("customers.name")},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.shipping.name,"onUpdate:modelValue":t[32]||(t[32]=n=>e(o).currentCustomer.shipping.name=n),modelModifiers:{trim:!0},"content-loading":e(l),type:"text",name:"address_name"},null,8,["modelValue","content-loading"])]),_:1},8,["content-loading","label"]),r(u,{label:s.$t("customers.country"),"content-loading":e(l)},{default:a(()=>[r(z,{modelValue:e(o).currentCustomer.shipping.country_id,"onUpdate:modelValue":t[33]||(t[33]=n=>e(o).currentCustomer.shipping.country_id=n),"value-prop":"id",label:"name","track-by":"name","resolve-on-load":"",searchable:"","content-loading":e(l),options:e(q).countries,placeholder:s.$t("general.select_country"),class:"w-full"},null,8,["modelValue","content-loading","options","placeholder"])]),_:1},8,["label","content-loading"]),r(u,{label:s.$t("customers.state"),"content-loading":e(l)},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.shipping.state,"onUpdate:modelValue":t[34]||(t[34]=n=>e(o).currentCustomer.shipping.state=n),"content-loading":e(l),name:"shipping.state",type:"text"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),r(u,{"content-loading":e(l),label:s.$t("customers.city")},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.shipping.city,"onUpdate:modelValue":t[35]||(t[35]=n=>e(o).currentCustomer.shipping.city=n),"content-loading":e(l),name:"shipping.city",type:"text"},null,8,["modelValue","content-loading"])]),_:1},8,["content-loading","label"]),r(u,{label:s.$t("customers.address"),"content-loading":e(l),error:e(i).currentCustomer.shipping.address_street_1.$error&&e(i).currentCustomer.shipping.address_street_1.$errors[0].$message||e(i).currentCustomer.shipping.address_street_2.$error&&e(i).currentCustomer.shipping.address_street_2.$errors[0].$message},{default:a(()=>[r(U,{modelValue:e(o).currentCustomer.shipping.address_street_1,"onUpdate:modelValue":t[36]||(t[36]=n=>e(o).currentCustomer.shipping.address_street_1=n),modelModifiers:{trim:!0},"content-loading":e(l),type:"text",placeholder:s.$t("general.street_1"),name:"shipping_street1",onInput:t[37]||(t[37]=n=>e(i).currentCustomer.shipping.address_street_1.$touch())},null,8,["modelValue","content-loading","placeholder"]),r(U,{modelValue:e(o).currentCustomer.shipping.address_street_2,"onUpdate:modelValue":t[38]||(t[38]=n=>e(o).currentCustomer.shipping.address_street_2=n),modelModifiers:{trim:!0},"content-loading":e(l),type:"text",placeholder:s.$t("general.street_2"),name:"shipping_street2",class:"mt-3","container-class":"mt-3",onInput:t[39]||(t[39]=n=>e(i).currentCustomer.shipping.address_street_2.$touch())},null,8,["modelValue","content-loading","placeholder"])]),_:1},8,["label","content-loading","error"]),p("div",Ne,[r(u,{"content-loading":e(l),label:s.$t("customers.phone"),class:"text-left"},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.shipping.phone,"onUpdate:modelValue":t[40]||(t[40]=n=>e(o).currentCustomer.shipping.phone=n),modelModifiers:{trim:!0},"content-loading":e(l),type:"text",name:"phone"},null,8,["modelValue","content-loading"])]),_:1},8,["content-loading","label"]),r(u,{label:s.$t("customers.zip_code"),"content-loading":e(l),class:"mt-2 text-left"},{default:a(()=>[r(d,{modelValue:e(o).currentCustomer.shipping.zip,"onUpdate:modelValue":t[41]||(t[41]=n=>e(o).currentCustomer.shipping.zip=n),modelModifiers:{trim:!0},"content-loading":e(l),type:"text",name:"zip"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"])])]),_:1})])):V("",!0),e(D).customFields.length>0?(C(),_(x,{key:1,class:"mb-5 md:mb-8"})):V("",!0),p("div",Re,[e(D).customFields.length>0?(C(),N("h6",He,$(s.$t("settings.custom_fields.title")),1)):V("",!0),p("div",Oe,[r(Me,{type:"Customer",store:e(o),"store-prop":"currentCustomer","is-edit":w.value,"is-loading":e(Y),"custom-field-scope":O},null,8,["store","is-edit","is-loading"])])])]),_:1})],32)]),_:1})}}};export{Ze as default};
