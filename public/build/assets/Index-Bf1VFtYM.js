import{as as ye,a6 as Be,u as Ie,v as he,a4 as ke,f as v,e as Ce,M as Ee,H as Ve,k as w,a8 as De,a9 as Te,W as $e,r as i,o as y,m as B,w as l,a as t,ab as V,ac as D,l as r,J as h,p as _,t as p,Q as f,K as F,a5 as G,b}from"./main-CO79g86p.js";import{_ as Se}from"./MoonwalkerIcon-X6zBP6TJ.js";import{_ as Ae}from"./InvoiceIndexDropdown-B4l8ApHJ.js";import{_ as Pe}from"./SendInvoiceModal-_tAK6T_V.js";import{_ as we}from"./CalendarModal-Czx7gT1x.js";import{u as Fe}from"./category-R7YScaiA.js";import"./mail-driver-CfdoGt3d.js";const Ne=b("div",{class:"hidden w-8 h-0 mx-4 border border-gray-400 border-solid xl:block",style:{"margin-top":"1.5rem"}},null,-1),Ue={class:"relative table-container"},Oe={class:"relative flex items-center justify-between h-10 mt-5 list-none border-b-2 border-gray-200 border-solid"},Re={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},xe={class:"absolute items-center left-6 top-2.5 select-none"},Le={class:"relative block"},Me={class:"flex justify-between"},Ke={__name:"Index",setup(We){const H=Fe(),c=ye(),z=Be();Ie();const{t:n}=he.useI18n();ke("$utils");const k=v(null),I=v(!1),Y=v([{label:"Status",options:["DRAFT","DUE","SENT","VIEWED","COMPLETED"]},{label:"Paid Status",options:["UNPAID","PAID","PARTIALLY_PAID"]},,]),T=v(!0),u=v("general.draft");Ce();const C=Ee();let s=Ve({customer_id:"",category_id:null,status:"",from_date:"",to_date:"",invoice_number:""});const N=v([]),$=v(!1);async function q(a=void 0){var d;$.value=!0;const o=await H.fetchCategories({search:a,type:"invoice",limit:"all"});o.data.data.length&&(N.value=((d=o.data)==null?void 0:d.data)||[]),$.value=!1}const U=w(()=>!c.invoiceTotalCount&&!T.value),O=w({get:()=>c.selectedInvoices,set:a=>c.selectInvoice(a)}),J=w(()=>[{key:"checkbox",thClass:"extra w-10",tdClass:"font-medium text-gray-900",placeholderClass:"w-10",sortable:!1},{key:"invoice_date",label:n("invoices.date"),thClass:"extra",tdClass:"font-medium"},{key:"invoice_number",label:n("invoices.number")},{key:"name",label:n("invoices.customer")},{key:"category.name",label:n("categories.label"),thClass:"extra",tdClass:"cursor-pointer font-medium text-primary-500"},{key:"status",label:n("invoices.status")},{key:"due_amount",label:n("dashboard.recent_invoices_card.amount_due")},{key:"total",label:n("invoices.total"),tdClass:"font-medium text-gray-900"},{key:"actions",label:n("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);De(s,()=>{ee()},{debounce:500}),Te(()=>{c.selectAllField&&c.selectAllInvoices()});function K(){return C.hasAbilities([f.DELETE_INVOICE,f.EDIT_INVOICE,f.VIEW_INVOICE,f.SEND_INVOICE])}async function Q(a,o){s.status="",S()}function S(){k.value&&k.value.refresh()}async function X({page:a,filter:o,sort:d}){let A={customer_id:s.customer_id,category_id:s.category_id,status:s.status,from_date:s.from_date,to_date:s.to_date,invoice_number:s.invoice_number,orderByField:d.fieldName||"created_at",orderBy:d.order||"desc",page:a};T.value=!0;let m=await c.fetchInvoices(A);return T.value=!1,{data:m.data.data,pagination:{totalPages:m.data.meta.last_page,currentPage:a,totalCount:m.data.meta.total,limit:10}}}function Z(a){if(u.value==a.title)return!0;switch(u.value=a.title,a.title){case n("general.draft"):s.status="DRAFT";break;case n("general.sent"):s.status="SENT";break;case n("general.due"):s.status="DUE";break;default:s.status="";break}}function ee(){c.$patch(a=>{a.selectedInvoices=[],a.selectAllField=!1}),S()}function R(){s.customer_id="",s.category_id="",s.status="",s.from_date="",s.to_date="",s.invoice_number="",u.value=n("general.all")}async function te(){z.openDialog({title:n("general.are_you_sure"),message:n("invoices.confirm_delete"),yesLabel:n("general.ok"),noLabel:n("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async a=>{a&&await c.deleteMultipleInvoices().then(o=>{o.data.success&&(S(),c.$patch(d=>{d.selectedInvoices=[],d.selectAllField=!1}))})})}function ae(){I.value&&R(),I.value=!I.value}function le(a){switch(a){case"DRAFT":u.value=n("general.draft");break;case"SENT":u.value=n("general.sent");break;case"DUE":u.value=n("general.due");break;case"COMPLETED":u.value=n("invoices.completed");break;case"PAID":u.value=n("invoices.paid");break;case"UNPAID":u.value=n("invoices.unpaid");break;case"PARTIALLY_PAID":u.value=n("invoices.partially_paid");break;case"VIEWED":u.value=n("invoices.viewed");break;default:u.value=n("general.all");break}}return $e(()=>{q()}),(a,o)=>{const d=i("BaseBreadcrumbItem"),A=i("BaseBreadcrumb"),m=i("BaseIcon"),P=i("BaseButton"),x=i("router-link"),se=i("BasePageHeader"),oe=i("BaseCustomerSelectInput"),g=i("BaseInputGroup"),ne=i("BaseTreeSelect"),ie=i("BaseMultiselect"),L=i("BaseDatePicker"),re=i("BaseInput"),ce=i("BaseFilterWrapper"),ue=i("BaseEmptyPlaceholder"),E=i("BaseTab"),de=i("BaseTabGroup"),me=i("BaseDropdownItem"),_e=i("BaseDropdown"),M=i("BaseCheckbox"),pe=i("BaseText"),W=i("BaseFormatMoney"),ve=i("BaseInvoiceStatusBadge"),j=i("BasePaidStatusBadge"),fe=i("BaseTable"),be=i("BasePage");return y(),B(be,null,{default:l(()=>[t(we),t(Pe),t(se,{title:a.$t("invoices.title")},{actions:l(()=>[V(t(P,{variant:"primary-outline",onClick:ae},{right:l(e=>[I.value?(y(),B(m,{key:1,name:"XIcon",class:h(e.class)},null,8,["class"])):(y(),B(m,{key:0,name:"FilterIcon",class:h(e.class)},null,8,["class"]))]),default:l(()=>[_(p(a.$t("general.filter"))+" ",1)]),_:1},512),[[D,r(c).invoiceTotalCount]]),r(C).hasAbilities(r(f).CREATE_INVOICE)?(y(),B(x,{key:0,to:"invoices/create"},{default:l(()=>[t(P,{variant:"primary",class:"ml-4"},{left:l(e=>[t(m,{name:"PlusIcon",class:h(e.class)},null,8,["class"])]),default:l(()=>[_(" "+p(a.$t("invoices.new_invoice")),1)]),_:1})]),_:1})):F("",!0)]),default:l(()=>[t(A,null,{default:l(()=>[t(d,{title:a.$t("general.home"),to:"dashboard"},null,8,["title"]),t(d,{title:a.$t("invoices.invoice",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),V(t(ce,{"row-on-xl":!0,onClear:R},{default:l(()=>[t(g,{label:a.$t("customers.customer",1)},{default:l(()=>[t(oe,{modelValue:r(s).customer_id,"onUpdate:modelValue":o[0]||(o[0]=e=>r(s).customer_id=e),placeholder:a.$t("customers.type_or_click"),"value-prop":"id",label:"name"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(g,{label:a.$t("categories.label"),class:"text-left"},{default:l(()=>[t(ne,{name:"parent_id","value-prop":"id","label-prop":"name",placeholder:a.$t("categories.select_a_category"),"parent-prop":"parent_id",options:N.value,loading:$.value,modelValue:r(s).category_id,"onUpdate:modelValue":o[1]||(o[1]=e=>r(s).category_id=e)},null,8,["placeholder","options","loading","modelValue"])]),_:1},8,["label"]),t(g,{label:a.$t("invoices.status")},{default:l(()=>[t(ie,{modelValue:r(s).status,"onUpdate:modelValue":[o[2]||(o[2]=e=>r(s).status=e),le],groups:!0,options:Y.value,searchable:"",placeholder:a.$t("general.select_a_status"),onRemove:o[3]||(o[3]=e=>Q())},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),t(g,{label:a.$t("general.from")},{default:l(()=>[t(L,{modelValue:r(s).from_date,"onUpdate:modelValue":o[4]||(o[4]=e=>r(s).from_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),Ne,t(g,{label:a.$t("general.to"),class:"mt-2"},{default:l(()=>[t(L,{modelValue:r(s).to_date,"onUpdate:modelValue":o[5]||(o[5]=e=>r(s).to_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),t(g,{label:a.$t("invoices.invoice_number")},{default:l(()=>[t(re,{modelValue:r(s).invoice_number,"onUpdate:modelValue":o[6]||(o[6]=e=>r(s).invoice_number=e)},{left:l(e=>[t(m,{name:"HashtagIcon",class:h(e.class)},null,8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},512),[[D,I.value]]),V(t(ue,{title:a.$t("invoices.no_invoices"),description:a.$t("invoices.list_of_invoices")},G({default:l(()=>[t(Se,{class:"mt-5 mb-4"})]),_:2},[r(C).hasAbilities(r(f).CREATE_INVOICE)?{name:"actions",fn:l(()=>[t(P,{variant:"primary-outline",onClick:o[7]||(o[7]=e=>a.$router.push("/admin/invoices/create"))},{left:l(e=>[t(m,{name:"PlusIcon",class:h(e.class)},null,8,["class"])]),default:l(()=>[_(" "+p(a.$t("invoices.add_new_invoice")),1)]),_:1})]),key:"0"}:void 0]),1032,["title","description"]),[[D,U.value]]),V(b("div",Ue,[b("div",Oe,[t(de,{class:"-mb-5",onChange:Z},{default:l(()=>[t(E,{title:a.$t("general.all"),filter:""},null,8,["title"]),t(E,{title:a.$t("general.draft"),filter:"DRAFT"},null,8,["title"]),t(E,{title:a.$t("general.sent"),filter:"SENT"},null,8,["title"]),t(E,{title:a.$t("general.due"),filter:"DUE"},null,8,["title"])]),_:1}),r(c).selectedInvoices.length&&r(C).hasAbilities(r(f).DELETE_INVOICE)?(y(),B(_e,{key:0,class:"absolute float-right"},{activator:l(()=>[b("span",Re,[_(p(a.$t("general.actions"))+" ",1),t(m,{name:"ChevronDownIcon"})])]),default:l(()=>[t(me,{onClick:te},{default:l(()=>[t(m,{name:"TrashIcon",class:"mr-3 text-gray-600"}),_(" "+p(a.$t("general.delete")),1)]),_:1})]),_:1})):F("",!0)]),t(fe,{ref_key:"table",ref:k,data:X,columns:J.value,"placeholder-count":r(c).invoiceTotalCount>=20?10:5,class:"mt-10"},G({header:l(()=>[b("div",xe,[t(M,{modelValue:r(c).selectAllField,"onUpdate:modelValue":o[8]||(o[8]=e=>r(c).selectAllField=e),variant:"primary",onChange:r(c).selectAllInvoices},null,8,["modelValue","onChange"])])]),"cell-checkbox":l(({row:e})=>[b("div",Le,[t(M,{id:e.id,modelValue:O.value,"onUpdate:modelValue":o[9]||(o[9]=ge=>O.value=ge),value:e.data.id},null,8,["id","modelValue","value"])])]),"cell-name":l(({row:e})=>[t(pe,{text:e.data.customer.name,length:30},null,8,["text"])]),"cell-invoice_number":l(({row:e})=>[t(x,{to:{path:`invoices/${e.data.id}/view`},class:"font-medium text-primary-500"},{default:l(()=>[_(p(e.data.invoice_number),1)]),_:2},1032,["to"])]),"cell-invoice_date":l(({row:e})=>[_(p(e.data.formatted_invoice_date),1)]),"cell-total":l(({row:e})=>[t(W,{amount:e.data.total,currency:e.data.customer.currency},null,8,["amount","currency"])]),"cell-status":l(({row:e})=>[t(ve,{status:e.data.status,class:"px-3 py-1"},{default:l(()=>[_(p(e.data.status),1)]),_:2},1032,["status"])]),"cell-due_amount":l(({row:e})=>[b("div",Me,[t(W,{amount:e.data.due_amount,currency:e.data.currency},null,8,["amount","currency"]),e.data.overdue?(y(),B(j,{key:0,status:"OVERDUE",class:"px-1 py-0.5 ml-2"},{default:l(()=>[_(p(a.$t("invoices.overdue")),1)]),_:1})):F("",!0),t(j,{status:e.data.paid_status,class:"px-1 py-0.5 ml-2"},{default:l(()=>[_(p(e.data.paid_status),1)]),_:2},1032,["status"])])]),_:2},[K()?{name:"cell-actions",fn:l(({row:e})=>[t(Ae,{row:e.data,table:k.value},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns","placeholder-count"])],512),[[D,!U.value]])]),_:1})}}};export{Ke as default};
